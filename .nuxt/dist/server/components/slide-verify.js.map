{"version":3,"file":"components/slide-verify.js","sources":["webpack:///./components/SlideVerify.vue?5ce6","webpack:///./components/SlideVerify.vue?8e64","webpack:///./components/SlideVerify.vue?61f0","webpack:///./components/SlideVerify.vue?7acd","webpack:///./components/SlideVerify.vue","webpack:///./components/SlideVerify.vue?1e34","webpack:///./components/SlideVerify.vue?30a5"],"sourcesContent":["// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../node_modules/@nuxt/postcss8/node_modules/css-loader/dist/cjs.js??ref--3-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/@nuxt/postcss8/node_modules/postcss-loader/dist/cjs.js??ref--3-oneOf-1-2!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./SlideVerify.vue?vue&type=style&index=0&id=8cb765a6&scoped=true&lang=css&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add CSS to SSR context\nvar add = require(\"!../node_modules/vue-style-loader/lib/addStylesServer.js\").default\nmodule.exports.__inject__ = function (context) {\n  add(\"e64c0c3a\", content, true, context)\n};","export * from \"-!../node_modules/vue-style-loader/index.js??ref--3-oneOf-1-0!../node_modules/@nuxt/postcss8/node_modules/css-loader/dist/cjs.js??ref--3-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/@nuxt/postcss8/node_modules/postcss-loader/dist/cjs.js??ref--3-oneOf-1-2!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./SlideVerify.vue?vue&type=style&index=0&id=8cb765a6&scoped=true&lang=css&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/@nuxt/postcss8/node_modules/css-loader/dist/runtime/api.js\");\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(function(i){return i[1]});\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".slide-verify[data-v-8cb765a6]{\\n  position:relative;\\n  width:310px;\\n  overflow:hidden\\n}\\n.slide-verify-block[data-v-8cb765a6]{\\n  position:absolute;\\n  left:0;\\n  top:0\\n}\\n.slide-verify-refresh-icon[data-v-8cb765a6]{\\n  position:absolute;\\n  right:0;\\n  top:0;\\n  width:34px;\\n  height:34px;\\n  cursor:pointer;\\n  content:\\\"刷新\\\";\\n  font-size:22px;\\n  line-height:34px;\\n  text-align:center;\\n  font-weight:700;\\n  color:#3fdeae;\\n  background-size:34px 471px\\n}\\n.slide-verify-refresh-icon[data-v-8cb765a6]:hover{\\n  transform:rotate(180deg);\\n  transition:all .2s ease-in-out\\n}\\n.slide-verify-slider[data-v-8cb765a6]{\\n  position:relative;\\n  text-align:center;\\n  width:310px;\\n  height:40px;\\n  line-height:40px;\\n  margin-top:15px;\\n  background:#f7f9fa;\\n  color:#45494c;\\n  border:1px solid #e4e7eb\\n}\\n.slide-verify-slider-mask[data-v-8cb765a6]{\\n  position:absolute;\\n  left:0;\\n  top:0;\\n  height:40px;\\n  border:0 solid #1991fa;\\n  background:#d1e9fe\\n}\\n.slide-verify-info[data-v-8cb765a6]{\\n  position:absolute;\\n  top:170px;\\n  left:0;\\n  height:30px;\\n  width:350px;\\n  color:#fff;\\n  text-align:center;\\n  line-height:30px;\\n  background-color:#52ccba;\\n  opacity:0\\n}\\n.slide-verify-info.fail[data-v-8cb765a6]{\\n  background-color:#f57a7a\\n}\\n.slide-verify-info.show[data-v-8cb765a6]{\\n  -webkit-animation:hide-data-v-8cb765a6 1s ease;\\n          animation:hide-data-v-8cb765a6 1s ease\\n}\\n@-webkit-keyframes hide-data-v-8cb765a6{\\n0%{\\n    opacity:0\\n}\\nto{\\n    opacity:.9\\n}\\n}\\n@keyframes hide-data-v-8cb765a6{\\n0%{\\n    opacity:0\\n}\\nto{\\n    opacity:.9\\n}\\n}\\n.slide-verify-slider-mask-item[data-v-8cb765a6]{\\n  position:absolute;\\n  top:0;\\n  left:0;\\n  width:38px;\\n  height:38px;\\n  background:#fff;\\n  box-shadow:0 0 3px rgba(0,0,0,.3);\\n  cursor:pointer;\\n  transition:background .2s linear\\n}\\n.slide-verify-slider-mask-item[data-v-8cb765a6]:hover{\\n  background:#1991fa\\n}\\n.slide-verify-slider-mask-item:hover .slide-verify-slider-mask-item-icon[data-v-8cb765a6]{\\n  background-position:0 -13px\\n}\\n.slide-verify-slider-mask-item-icon[data-v-8cb765a6]{\\n  position:absolute;\\n  top:9px;\\n  left:7px;\\n  width:14px;\\n  height:12px;\\n  content:\\\"法币\\\";\\n  font-size:22px;\\n  color:#ddd\\n}\\n.container-active .slide-verify-slider-mask-item[data-v-8cb765a6]{\\n  height:38px;\\n  top:-1px;\\n  border:1px solid #1991fa\\n}\\n.container-active .slide-verify-slider-mask[data-v-8cb765a6]{\\n  height:38px;\\n  border-width:1px\\n}\\n.container-success .slide-verify-slider-mask-item[data-v-8cb765a6]{\\n  height:38px;\\n  top:-1px;\\n  border:1px solid #52ccba;\\n  background-color:#52ccba!important\\n}\\n.container-success .slide-verify-slider-mask[data-v-8cb765a6]{\\n  height:38px;\\n  border:1px solid #52ccba;\\n  background-color:#d2f4ef\\n}\\n.container-success .slide-verify-slider-mask-item-icon[data-v-8cb765a6]{\\n  background-position:0 0!important\\n}\\n.container-fail .slide-verify-slider-mask-item[data-v-8cb765a6]{\\n  height:38px;\\n  top:-1px;\\n  border:1px solid #f57a7a;\\n  background-color:#f57a7a!important\\n}\\n.container-fail .slide-verify-slider-mask[data-v-8cb765a6]{\\n  height:38px;\\n  border:1px solid #f57a7a;\\n  background-color:#fce1e1\\n}\\n.container-fail .slide-verify-slider-mask-item-icon[data-v-8cb765a6]{\\n  top:14px;\\n  background-position:0 -82px!important\\n}\\n.container-active .slide-verify-slider-text[data-v-8cb765a6],.container-fail .slide-verify-slider-text[data-v-8cb765a6],.container-success .slide-verify-slider-text[data-v-8cb765a6]{\\n  display:none\\n}\", \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {};\nmodule.exports = ___CSS_LOADER_EXPORT___;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"slide-verify\",style:(_vm.widthlable),attrs:{\"id\":\"slideVerify\",\"onselectstart\":\"return false;\"}},[_vm._ssrNode(\"<canvas\"+(_vm._ssrAttr(\"width\",_vm.w))+(_vm._ssrAttr(\"height\",_vm.h))+\" data-v-8cb765a6></canvas> <canvas\"+(_vm._ssrAttr(\"width\",_vm.w))+(_vm._ssrAttr(\"height\",_vm.h))+\" class=\\\"slide-verify-block\\\" data-v-8cb765a6></canvas> <div class=\\\"slide-verify-refresh-icon el-icon-refresh\\\" data-v-8cb765a6></div> <div\"+(_vm._ssrClass(\"slide-verify-info\",{fail: _vm.fail, show: _vm.showInfo}))+\" data-v-8cb765a6>\"+_vm._ssrEscape(_vm._s(_vm.infoText))+\"</div> <div\"+(_vm._ssrClass(\"slide-verify-slider\",{'container-active': _vm.containerActive, 'container-success': _vm.containerSuccess, 'container-fail': _vm.containerFail}))+(_vm._ssrStyle(null,_vm.widthlable, null))+\" data-v-8cb765a6><div class=\\\"slide-verify-slider-mask\\\"\"+(_vm._ssrStyle(null,{width: _vm.sliderMaskWidth}, null))+\" data-v-8cb765a6><div class=\\\"slide-verify-slider-mask-item\\\"\"+(_vm._ssrStyle(null,{left: _vm.sliderLeft}, null))+\" data-v-8cb765a6><div class=\\\"slide-verify-slider-mask-item-icon el-icon-s-unfold\\\" data-v-8cb765a6></div></div></div> <span class=\\\"slide-verify-slider-text\\\" data-v-8cb765a6>\"+_vm._ssrEscape(_vm._s(_vm.sliderText))+\"</span></div>\")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nfunction sum (x, y) {\r\n  return x + y\r\n}\r\n\r\nfunction square (x) {\r\n  return x * x\r\n}\r\nexport default {\r\n  name: 'SlideVerify',\r\n  props: {\r\n    // block length\r\n    l: {\r\n      type: Number,\r\n      default: 42\r\n    },\r\n    // block radius\r\n    r: {\r\n      type: Number,\r\n      default: 10\r\n    },\r\n    // canvas width\r\n    w: { // 背景图宽\r\n      type: [Number, String],\r\n      default: 350\r\n    },\r\n    // canvas height\r\n    h: { // 背景图高\r\n      type: [Number, String],\r\n      default: 200\r\n    },\r\n    // canvas width\r\n    sw: { // 小图宽\r\n      type: [Number, String],\r\n      default: 50\r\n    },\r\n    // canvas height\r\n    sh: {\r\n      type: [Number, String],\r\n      default: 50\r\n    },\r\n    // block_x: {\r\n    //   type: Number,\r\n    //   default: 155\r\n    // },\r\n    blocky: { // 小图初始的垂直距离\r\n      type: [Number, String],\r\n      default: 20\r\n    },\r\n    sliderText: {\r\n      type: String,\r\n      default: 'Slide filled right'\r\n    },\r\n    imgurl: { // 大图地址\r\n      type: String,\r\n      default: ''\r\n    },\r\n    miniimgurl: { // 小图地址\r\n      type: String,\r\n      default: ''\r\n    },\r\n    fresh: {\r\n      type: Boolean,\r\n      default: false\r\n    }\r\n  },\r\n\r\n  data () {\r\n    return {\r\n      containerActive: false, // container active class\r\n      containerSuccess: false, // container success class\r\n      containerFail: false, // container fail class\r\n      canvasCtx: null,\r\n      blockCtx: null,\r\n      block: null,\r\n      canvasStr: null,\r\n      // block_x: undefined, // container random position\r\n      // blocky: undefined,\r\n      L: this.l + this.r * 2 + 3, // block real lenght\r\n      img: undefined,\r\n      originX: undefined,\r\n      originY: undefined,\r\n      isMouseDown: false,\r\n      trail: [],\r\n      widthlable: '',\r\n      sliderLeft: 0, // block right offset\r\n      sliderMaskWidth: 0, // mask width\r\n      dialogVisible: false,\r\n      infoText: '验证成功',\r\n      fail: false,\r\n      showInfo: false\r\n    }\r\n  },\r\n  watch: {\r\n    fresh (val) {\r\n      if (val) {\r\n        this.init()\r\n      }\r\n    }\r\n  },\r\n  mounted () {\r\n    // 随机生成数this.block_x =\r\n    this.init()\r\n  },\r\n  methods: {\r\n    init () {\r\n      this.initDom()\r\n      this.bindEvents()\r\n      this.widthlable = 'width:' + this.w + 'px;'\r\n    },\r\n    initDom () {\r\n      this.block = this.$refs.block\r\n      this.canvasStr = this.$refs.canvas\r\n\r\n      this.canvasCtx = this.canvasStr.getContext('2d')\r\n      this.blockCtx = this.block.getContext('2d')\r\n      this.initImg()\r\n    },\r\n    initImg (h) {\r\n      var that = this\r\n      const img = document.createElement('img')\r\n      img.onload = onload\r\n      img.onerror = () => {\r\n        img.src = that.imgurl\r\n      }\r\n      img.src = that.imgurl\r\n      img.onload = function () {\r\n        that.canvasCtx.drawImage(img, 0, 0, that.w, that.h)\r\n      }\r\n\r\n      this.img = img\r\n      const img1 = document.createElement('img')\r\n      var blockCtx = that.blockCtx\r\n      var blocky = h || that.blocky\r\n      if (blocky === 0) {\r\n        return\r\n      }\r\n      img1.onerror = () => {\r\n        img1.src = that.miniimgurl\r\n      }\r\n      img1.src = that.miniimgurl\r\n      img1.onload = function () {\r\n        // blockCtx.drawImage(img1, 0, blocky, that.sw, that.sh)\r\n        blockCtx.drawImage(img1, 0, blocky, 55, 45)\r\n      }\r\n      // console.log(777, h)\r\n    },　　// 刷新\r\n    refresh () {\r\n      this.$emit('refresh')\r\n    },\r\n    sliderDown (event) {\r\n      this.originX = event.clientX\r\n      this.originY = event.clientY\r\n      this.isMouseDown = true\r\n    },\r\n    touchStartEvent (e) {\r\n      this.originX = e.changedTouches[0].pageX\r\n      this.originY = e.changedTouches[0].pageY\r\n      this.isMouseDown = true\r\n    },\r\n    bindEvents () {\r\n      document.addEventListener('mousemove', e => {\r\n        if (!this.isMouseDown) return false\r\n        const moveX = e.clientX - this.originX\r\n        const moveY = e.clientY - this.originY\r\n        if (moveX < 0 || moveX + 38 >= this.w) return false\r\n        this.sliderLeft = moveX + 'px'\r\n        const blockLeft = ((this.w - 40 - 20) / (this.w - 40)) * moveX\r\n        this.block.style.left = blockLeft + 'px'\r\n        this.containerActive = true // add active\r\n        this.sliderMaskWidth = moveX + 'px'\r\n        this.trail.push(moveY)\r\n      }, { passive: true })\r\n      document.addEventListener('mouseup', e => {\r\n        if (!this.isMouseDown) return false\r\n        this.isMouseDown = false\r\n        if (e.clientX === this.originX) return false\r\n        this.containerActive = false // remove active\r\n        this.verify()\r\n      }, { passive: true })\r\n    },\r\n    touchMoveEvent (e) {\r\n      if (!this.isMouseDown) return false\r\n      const moveX = e.changedTouches[0].pageX - this.originX\r\n      const moveY = e.changedTouches[0].pageY - this.originY\r\n      if (moveX < 0 || moveX + 38 >= this.w) return false\r\n      this.sliderLeft = moveX + 'px'\r\n      const blockLeft = ((this.w - 40 - 20) / (this.w - 40)) * moveX\r\n      this.block.style.left = blockLeft + 'px'\r\n\r\n      this.containerActive = true\r\n      this.sliderMaskWidth = moveX + 'px'\r\n      this.trail.push(moveY)\r\n    },\r\n    touchEndEvent (e) {\r\n      if (!this.isMouseDown) return false\r\n      this.isMouseDown = false\r\n      if (e.changedTouches[0].pageX === this.originX) return false\r\n      this.containerActive = false\r\n      this.verify()\r\n    },\r\n    verify () {\r\n      const arr = this.trail // drag y move distance\r\n      const average = arr.reduce(sum) / arr.length // average\r\n      const deviations = arr.map(x => x - average) // deviation array\r\n      const stddev = Math.sqrt(deviations.map(square).reduce(sum) / arr.length) // standard deviation\r\n      const left = parseInt(this.block.style.left)\r\n      this.$emit('success', left, stddev)\r\n    },\r\n    reset (h) {\r\n      this.containerActive = false\r\n      this.containerSuccess = false\r\n      this.containerFail = false\r\n      this.sliderLeft = 0\r\n      this.block.style.left = 0\r\n      this.sliderMaskWidth = 0\r\n      this.canvasCtx.clearRect(0, 0, this.w, this.h)\r\n      this.blockCtx.clearRect(0, 0, this.w, this.h)\r\n      this.fail = false\r\n      this.showInfo = false\r\n      this.containerFail = false\r\n      this.containerSuccess = false\r\n      this.initImg(h)\r\n    },\r\n    handleFail () {\r\n      this.fail = true\r\n      this.showInfo = true\r\n      this.infoText = '验证失败'\r\n      this.containerFail = true\r\n      // console.log(6666)\r\n      // setTimeout(() => {\r\n      //   this.block.style.left = 0\r\n      //   this.sliderMaskWidth = 0\r\n      //   this.sliderLeft = 0\r\n      //   this.fail = false\r\n      //   this.showInfo = false\r\n      //   this.containerFail = false\r\n      // }, 800)\r\n    },\r\n    handleSuccess () {\r\n      // console.log(777)\r\n      this.showInfo = true\r\n      this.infoText = '验证成功'\r\n      this.containerSuccess = true\r\n      setTimeout(() => {\r\n        this.block.style.left = 0\r\n        this.sliderMaskWidth = 0\r\n        this.sliderLeft = 0\r\n        this.fail = false\r\n        this.showInfo = false\r\n        this.containerSuccess = false\r\n      }, 1000)\r\n    }\r\n  }\r\n}\r\n","import mod from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./SlideVerify.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./SlideVerify.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SlideVerify.vue?vue&type=template&id=8cb765a6&scoped=true&\"\nimport script from \"./SlideVerify.vue?vue&type=script&lang=js&\"\nexport * from \"./SlideVerify.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  var style0 = require(\"./SlideVerify.vue?vue&type=style&index=0&id=8cb765a6&scoped=true&lang=css&\")\nif (style0.__inject__) style0.__inject__(context)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  \"8cb765a6\",\n  \"23d7bc64\"\n  \n)\n\nexport default component.exports"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACXA;AAAA;AAAA;AAAA;;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACPA;AACA;AACA;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAFA;AAIA;AAAA;AACA;AACA;AAFA;AAIA;AAAA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAFA;AAnDA;AACA;AAwDA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AAtBA;AAwBA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AACA;AAMA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AArJA;AAhGA;;AC7DA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}