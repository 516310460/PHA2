(window.webpackJsonp=window.webpackJsonp||[]).push([[14,15,16],{1127:function(t,e,n){"use strict";n.r(e);n(184),n(71),n(112),n(93),n(132),n(42),n(79),n(80),n(636);e.default={history:{},timer:{},pollingtimer:{},subs:[],init:function(){this.history={},this.timer={},this.subs=[]},formatBar:function(data,t,e,n,r){var o=this,sub=this.subs.find((function(t){return t.symbolInfo===e.name}));if(!sub||!sub.lastBar)return!1;var c=sub.lastBar,l=sub.resolution;l.includes("1D")?l=1440:l.includes("1W")&&(l=10080);var f=60*l,m=c.time/1e3;Array.isArray(data)||(data=[data]),data.sort((function(a,b){return a.t-b.t}));return data.map((function(e){var o={};return Math.floor(e.t/f)*f>m?(o={low:c.close,high:c.close,open:c.close,close:e.c,volume:e.v}).time=t.global_get_local_time(e.t).valueOf():(o=c,e.c<c.low?o.low=e.c:e.c>c.high&&(o.high=e.c),r||"1"!=l.toString()&&!n||(o.volume=e.v),o.close=e.c),o})).forEach((function(t){var n=t;if(n.time<c.time)return!0;setTimeout((function(){sub.listener(n)}),6),sub.lastBar=n,o.history[e.name].lastBar=n})),!0},gettimer:function(t){switch(t=t.toString()){case"1":return 2e3;case"5":case"15":case"30":case"60":case"240":case"D":case"1D":case"1W":case"1M":return 5e3}},getLastBarsOther:function(t,e,n,r,o,c,l){var f=this;t.$pubsub.subscribe(t.$pubsub.changeNewMoney,(function(sub,n){if(n&&n.symble==t.symbleParameString){var data={t:n.ts,c:n.price,v:n.amount};f.formatBar.call(f,data,t,e,!1,!0)}})),function n(){t.$store.dispatch(t.$socket.url.quotation_kline_get,{type:t.resolutionInterval,size:1,symble:t.symbleParameString}).then((function(r){var data=r.data;if(data){var o=f.timer[e.name+"_"+t.resolutionInterval],sub=f.subs.find((function(t){return t.symbolInfo===e.name}));if(!sub)return;for(var c in-1!=o&&(sub=f.formatBar.call(f,data,t,e,!0)),f.timer)clearTimeout(f.timer[c]),f.timer[c]=-1;sub&&-1!=o&&(f.timer[e.name+"_"+t.resolutionInterval]=setTimeout(n,15e3))}}))}()},getLastBars:function(t,e,n,r,o,c,l){var f=this;t.$socket.invoke({sub:t.sub,type:t.$socket.type.quotation_kline_get}),t.$socket.is()||function r(){t.$store.dispatch(t.$socket.url.quotation_kline_get,{type:t.resolutionInterval,size:1,symble:t.symbleParameString}).then((function(o){var data=o.data;if(data){var c=f.formatBar.call(f,data,t,e);for(var l in f.pollingtimer)clearTimeout(f.pollingtimer[l]),f.pollingtimer[l]=-1;c&&(f.pollingtimer[e.name]=setTimeout(r,f.gettimer(n)))}}))}(),t.$socket.receive(t.$socket.type.quotation_kline_get,(function(n){if(n&&n.topic==t.sub){var data=n.data;f.formatBar.call(f,data,t,e)||t.$socket.uninvoke(t.$socket.type.quotation_kline_get)}}))},getBars:function(t,e,n,r,o,c,l){var f=o;this.history[e.name]&&this.history[e.name].firstBar&&(f=this.history[e.name].firstBar.time/1e3);var m={etime:f,type:t.resolutionInterval,symble:t.symbleParameString},h=this;return t.$store.dispatch("quotation_kline_get",m).then((function(n){var data=n.data;if(data){data.sort((function(a,b){return a.t-b.t}));var r=t.bars=data.map((function(e){return{time:t.global_get_local_time(e.t).valueOf(),low:e.l,high:e.h,open:e.o,close:e.c,volume:e.v}}));return h.history[e.name]={lastBar:r[r.length-1],firstBar:r[0]},r}return[]}))}}},1146:function(t,e,n){"use strict";var r=n(35),o=n(225)(6),c="findIndex",l=!0;c in[]&&Array(1)[c]((function(){l=!1})),r(r.P+r.F*l,"Array",{findIndex:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),n(185)(c)},1165:function(t,e,n){"use strict";n.r(e);n(71),n(1146);var r=n(1127);e.default={subscribeBars:function(t,e,n,o,c){var l=r.default.history[t.name]?r.default.history[t.name].lastBar:null,f={uid:o,resolution:e,symbolInfo:t.name,lastBar:l,listener:n};r.default.subs.push(f)},unsubscribeBars:function(t){var e=r.default.subs.findIndex((function(e){return e.uid===t}));-1!==e&&r.default.subs.splice(e,1)}}},1203:function(t,e,n){"use strict";n.r(e);n(226);var r=n(1165),o=n(1127),c=["1","5","10","15","30","60","120","240","360","720","4H","1D","1W","1M"];e.default={createFeed:function(t){return o.default.init(),{onReady:function(t){setTimeout((function(){return t({supported_resolutions:c})}),0)},searchSymbols:function(t,e,n,r){},resolveSymbol:function(e,n,r){var o={name:t.from+":"+t.to,ticker:t.from+":"+t.to,type:"crypto",session:"24x7",regular_session:"24x7",minmov:1,pricescale:1e8,has_intraday:!0,has_daily:!0,has_weekly_and_monthly:!0,volume_precision:8,data_status:"streaming",intraday_multipliers:c,timezone:t.timezone};t.to.toUpperCase().match(/USD|EUR|JPY|AUD|GBP|KRW|CNY/)&&(o.pricescale=100),setTimeout((function(){n(o)}),0)},getBars:function(e,n,r,c,l,f,m){o.default.getBars(t,e,n,r,c,m).then((function(f){f.length?setTimeout((function(){l(f),m&&["1","5"].indexOf(n)>=0&&(o.default.getLastBars(t,e,n,r,c,m),o.default.getLastBarsOther(t,e,n,r,c,m))}),6):setTimeout((function(){l(f,{noData:!0})}),6)})).catch((function(t){f(t)}))},subscribeBars:function(t,e,n,o,c){r.default.subscribeBars(t,e,n,o,c)},unsubscribeBars:function(t){r.default.unsubscribeBars(t)},calculateHistoryDepth:function(t,e,n){},getMarks:function(t,e,n,r,o){var c=function(){for(var t=1,time=Date.parse(new Date)/1e3,e={border:"#103bff",background:"#ff00e9"},n=[],i=0;i<15;i++){var mark={};mark.id=t++,mark.time=time,time-=28800,mark.color=e,mark.text="这是标记: "+(t-1),mark.label="S",mark.labelFontColor="#ff8e53",mark.minSize=5,n.push(mark)}return n};setTimeout((function(){r(c)}),3e3)},getTimeScaleMarks:function(t,e,n,r,o){},getServerTime:function(t){}}}}}}]);